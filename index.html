<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Vinilo para Coches</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3498db">
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(to right, #f4f4f4, #e0e0e0);
      max-width: 960px;
      margin: auto;
      padding: 30px;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 30px;
    }
    header img {
      height: 60px;
    }
    h2 {
      color: #333;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: 600;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      margin-top: 20px;
      padding: 12px 25px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }
    button:hover {
      background-color: #388e3c;
    }
    .resultado {
      margin-top: 30px;
      padding: 20px;
      background-color: #ffffff;
      border-left: 5px solid #4CAF50;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 5px;
    }
    .section {
      margin-bottom: 30px;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .two-columns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    @media (max-width: 600px) {
      .two-columns { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <header>
    <img src="img/oracal.png" alt="Oracal logo">
    <img src="img/totenser.jpg" alt="Totensur logo">
  </header>

  <h2>Calculadora de Presupuesto para Vinilización de Vehículos</h2>

  <div class="section">
    <h3>Datos del Vehículo</h3>
    <div class="two-columns">
      <div>
        <label for="marca">Marca:</label>
        <select id="marca" onchange="cargarModelos()">
          <option value="">-- Selecciona marca --</option>
        </select>
      </div>
      <div>
        <label for="modelo">Modelo:</label>
        <select id="modelo">
          <option value="">-- Selecciona modelo --</option>
        </select>
      </div>
    </div>

    <div class="two-columns">
      <div>
        <label for="anio">Año del vehículo:</label>
        <input type="number" id="anio" min="1990" max="2025" value="2020">
      </div>
      <div>
        <label for="tipoVinil">Tipo de vinilo:</label>
        <select id="tipoVinil">
          <option value="standard">Vinilo estándar (€15/m²)</option>
          <option value="premium">Vinilo premium (€25/m²)</option>
          <option value="cambioColor">Cambio de color (€30/m²)</option>
          <option value="personalizado">Personalizado (€35/m²)</option>
        </select>
      </div>
    </div>
  </div>

  <div class="section">
    <h3>Parámetros de Trabajo</h3>
    <div class="two-columns">
      <div>
        <label for="factorComplejidad">Factor de complejidad:</label>
        <select id="factorComplejidad">
          <option value="1.0">Simple (1.0)</option>
          <option value="1.2" selected>Estándar (1.2)</option>
          <option value="1.5">Complejo (1.5)</option>
          <option value="2.0">Muy complejo (2.0)</option>
        </select>
      </div>
      <div>
        <label for="horasTrabajo">Horas estimadas de trabajo:</label>
        <input type="number" id="horasTrabajo" min="1" max="100" value="20">
      </div>
    </div>

    <div class="two-columns">
      <div>
        <label for="tarifaHora">Tarifa por hora (€):</label>
        <input type="number" id="tarifaHora" step="0.5" value="30">
      </div>
      <div>
        <label for="anchoVinilo">Ancho del vinilo (metros):</label>
        <input type="number" id="anchoVinilo" step="0.01" value="1.52">
      </div>
    </div>
  </div>

  <button onclick="calcularPresupuesto()">Calcular Presupuesto</button>

  <div class="resultado" id="resultado">
    <h3>Resultado del Presupuesto</h3>
    <p>Selecciona un vehículo y completa los parámetros para calcular.</p>
  </div>

  <script>
    // Base de datos completa de vehículos con dimensiones
    const baseDeDatos = {
      "Audi": {
        "A3": { largo: 4.34, ancho: 1.82, alto: 1.43 },
        "A4": { largo: 4.76, ancho: 1.84, alto: 1.43 },
        "A6": { largo: 4.94, ancho: 1.87, alto: 1.46 },
        "Q3": { largo: 4.38, ancho: 1.83, alto: 1.61 },
        "Q5": { largo: 4.66, ancho: 1.89, alto: 1.66 },
        "Q7": { largo: 5.06, ancho: 1.97, alto: 1.74 },
        "TT": { largo: 4.19, ancho: 1.84, alto: 1.35 }
      },
      "BMW": {
        "Serie 1": { largo: 4.32, ancho: 1.76, alto: 1.42 },
        "Serie 3": { largo: 4.63, ancho: 1.82, alto: 1.43 },
        "Serie 5": { largo: 4.94, ancho: 1.87, alto: 1.50 },
        "X1": { largo: 4.44, ancho: 1.82, alto: 1.61 },
        "X3": { largo: 4.71, ancho: 1.89, alto: 1.68 },
        "X5": { largo: 4.92, ancho: 2.00, alto: 1.74 }
      },
      "Citroën": {
        "C3": { largo: 3.99, ancho: 1.75, alto: 1.47 },
        "C4": { largo: 4.36, ancho: 1.80, alto: 1.52 },
        "C5": { largo: 4.82, ancho: 1.86, alto: 1.48 },
        "Berlingo": { largo: 4.40, ancho: 1.85, alto: 1.83 }
      },
      "Jaguar": {
        "XE": { largo: 4.67, ancho: 1.85, alto: 1.42 },
        "XF": { largo: 4.95, ancho: 1.88, alto: 1.46 },
        "F-PACE": { largo: 4.73, ancho: 1.94, alto: 1.67 }
      },
      "Jeep": {
        "Renegade": { largo: 4.23, ancho: 1.81, alto: 1.69 },
        "Cherokee": { largo: 4.65, ancho: 1.86, alto: 1.68 },
        "Grand Cherokee": { largo: 4.82, ancho: 1.94, alto: 1.79 }
      },
      "Mercedes": {
        "Clase A": { largo: 4.41, ancho: 1.80, alto: 1.44 },
        "Clase C": { largo: 4.69, ancho: 1.81, alto: 1.44 },
        "Clase E": { largo: 4.93, ancho: 1.85, alto: 1.47 },
        "GLA": { largo: 4.41, ancho: 1.83, alto: 1.61 },
        "GLC": { largo: 4.66, ancho: 1.89, alto: 1.64 }
      },
      "Peugeot": {
        "208": { largo: 4.05, ancho: 1.74, alto: 1.43 },
        "308": { largo: 4.25, ancho: 1.82, alto: 1.46 },
        "508": { largo: 4.75, ancho: 1.86, alto: 1.42 },
        "3008": { largo: 4.44, ancho: 1.84, alto: 1.62 }
      },
      "Renault": {
        "Clio": { largo: 4.05, ancho: 1.80, alto: 1.44 },
        "Megane": { largo: 4.36, ancho: 1.81, alto: 1.45 },
        "Kadjar": { largo: 4.45, ancho: 1.84, alto: 1.61 }
      },
      "Seat": {
        "Ibiza": { largo: 4.06, ancho: 1.75, alto: 1.44 },
        "León": { largo: 4.37, ancho: 1.80, alto: 1.46 },
        "Ateca": { largo: 4.36, ancho: 1.84, alto: 1.61 }
      },
      "Volkswagen": {
        "Golf": { largo: 4.26, ancho: 1.79, alto: 1.46 },
        "Passat": { largo: 4.77, ancho: 1.83, alto: 1.47 },
        "Tiguan": { largo: 4.49, ancho: 1.84, alto: 1.67 },
        "T-Roc": { largo: 4.23, ancho: 1.82, alto: 1.57 }
      }
    };

    // Cargar marcas al iniciar la página
    window.onload = function() {
      const marcaSelect = document.getElementById('marca');
      Object.keys(baseDeDatos).forEach(marca => {
        const option = document.createElement('option');
        option.value = marca;
        option.textContent = marca;
        marcaSelect.appendChild(option);
      });
    };

    function cargarModelos() {
      const marca = document.getElementById('marca').value;
      const modeloSelect = document.getElementById('modelo');
      modeloSelect.innerHTML = '<option value="">-- Selecciona modelo --</option>';
      
      if (marca && baseDeDatos[marca]) {
        Object.keys(baseDeDatos[marca]).forEach(modelo => {
          const option = document.createElement('option');
          option.value = modelo;
          option.textContent = modelo;
          modeloSelect.appendChild(option);
        });
      }
    }

    function calcularPresupuesto() {
      const marca = document.getElementById('marca').value;
      const modelo = document.getElementById('modelo').value;
      const tipoVinil = document.getElementById('tipoVinil').value;
      const factorComplejidad = parseFloat(document.getElementById('factorComplejidad').value);
      const horasTrabajo = parseInt(document.getElementById('horasTrabajo').value);
      const tarifaHora = parseFloat(document.getElementById('tarifaHora').value);
      const anchoVinilo = parseFloat(document.getElementById('anchoVinilo').value);

      if (!marca || !modelo || !baseDeDatos[marca][modelo]) {
        alert("Por favor, selecciona una marca y modelo válidos");
        return;
      }

      const vehiculo = baseDeDatos[marca][modelo];
      const [largo, ancho, alto] = [vehiculo.largo, vehiculo.ancho, vehiculo.alto];
      const areaSuperficial = 0.8 * (2 * (largo * alto + ancho * alto) + largo * ancho);
      const areaVinilo = areaSuperficial * factorComplejidad;
      const metrosLineales = areaVinilo / anchoVinilo;

      const preciosVinilo = {
        standard: 15,
        premium: 25,
        cambioColor: 30,
        personalizado: 35
      };

      const precioM2 = preciosVinilo[tipoVinil];
      const costeMaterial = areaVinilo * precioM2;
      const costeManoObra = horasTrabajo * tarifaHora;
      const costeTotal = costeMaterial + costeManoObra;

      document.getElementById('resultado').innerHTML = `
        <h3>Resultado del Presupuesto</h3>
        <p><strong>Vehículo:</strong> ${marca} ${modelo}</p>
        <div class="two-columns">
          <div>
            <h4>Medidas del vehículo:</h4>
            <p>Largo: ${largo.toFixed(2)} m</p>
            <p>Ancho: ${ancho.toFixed(2)} m</p>
            <p>Alto: ${alto.toFixed(2)} m</p>
            <p>Área superficial estimada: ${areaSuperficial.toFixed(2)} m²</p>
          </div>
          <div>
            <h4>Material:</h4>
            <p>Tipo de vinilo: ${document.getElementById('tipoVinil').selectedOptions[0].text}</p>
            <p>Área de vinilo necesaria: ${areaVinilo.toFixed(2)} m²</p>
            <p>Metros lineales (@${anchoVinilo}m ancho): ${metrosLineales.toFixed(2)} m</p>
          </div>
        </div>
        <div class="two-columns">
          <div>
            <h4>Costes:</h4>
            <p>Material: ${costeMaterial.toFixed(2)} €</p>
            <p>Mano de obra: ${costeManoObra.toFixed(2)} €</p>
            <p><strong>Total estimado:</strong> ${costeTotal.toFixed(2)} €</p>
          </div>
          <div>
            <h4>Desglose:</h4>
            <p>Precio por m²: ${precioM2} €</p>
            <p>Factor complejidad: ${factorComplejidad}</p>
            <p>Tarifa por hora: ${tarifaHora} €</p>
          </div>
        </div>
        <p><em>Nota: Este presupuesto es una estimación. Para un cálculo exacto, consulta con un profesional.</em></p>
      `;
    }
  </script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('✅ Service Worker registrado', reg))
          .catch(err => console.warn('❌ Error al registrar Service Worker', err));
      });
    }
  </script>
</body>
</html>